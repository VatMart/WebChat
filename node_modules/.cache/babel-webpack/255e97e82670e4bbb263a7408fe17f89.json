{"ast":null,"code":"import { MAT_DIALOG_DATA } from \"@angular/material/dialog\";\nimport { map } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/data-handler.service\";\nimport * as i2 from \"../../services/room.service\";\nimport * as i3 from \"../../services/message.service\";\nimport * as i4 from \"@angular/material/dialog\";\nimport * as i5 from \"../../services/token-storage.service\";\nimport * as i6 from \"../../services/notification.service\";\nimport * as i7 from \"../../services/image-upload.service\";\nimport * as i8 from \"@angular/common\";\nimport * as i9 from \"@angular/material/form-field\";\nimport * as i10 from \"@angular/material/input\";\nimport * as i11 from \"@angular/cdk/text-field\";\nimport * as i12 from \"@angular/forms\";\nimport * as i13 from \"@angular/material/button\";\nimport * as i14 from \"@angular/material/icon\";\nimport * as i15 from \"@angular/material/list\";\nimport * as i16 from \"@angular/material/divider\";\nconst _c0 = [\"scrollMe\"];\n\nfunction MessageListComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 23);\n    i0.ɵɵelementStart(1, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function MessageListComponent_div_7_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.openDialogMembers();\n    });\n    i0.ɵɵelementStart(2, \"mat-icon\");\n    i0.ɵɵtext(3, \"groups\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MessageListComponent_li_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 26);\n    i0.ɵɵtext(1, \"\\u0421\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u044F \\u043A\\u043E\\u043C\\u043D\\u0430\\u0442\\u044B\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MessageListComponent_li_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵelementStart(1, \"span\", 27);\n    i0.ɵɵelement(2, \"img\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 29);\n    i0.ɵɵelementStart(4, \"div\", 1);\n    i0.ɵɵelementStart(5, \"span\", 3);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"span\", 30);\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 31);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const message_r6 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    let tmp_2_0;\n    i0.ɵɵclassMapInterpolate1(\"ks-item \", message_r6.sender_id === ctx_r3.currentUserId ? ctx_r3.selfMessage : ctx_r3.fromMessage, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", ctx_r3.formatImage(ctx_r3.userImages == null ? null : ctx_r3.userImages.get(message_r6.sender_id)) || \"https://www.missingdogsuk.co.uk/wp-content/plugins/wp-job-manager-resumes/assets/images/candidate.png\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r3.messageService.getUserFromUserIdInRoom(ctx_r3.activeRoom, message_r6.sender_id) ? (tmp_2_0 = ctx_r3.messageService.getUserFromUserIdInRoom(ctx_r3.activeRoom, message_r6.sender_id)) == null ? null : tmp_2_0.nickname : \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(9, 7, message_r6.sendingDate, \"short\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(message_r6.text);\n  }\n}\n\nfunction DialogMembers_mat_list_item_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-list-item\");\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"face\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \"\\u0418\\u043C\\u044F:\\u00A0\");\n    i0.ɵɵelementStart(4, \"b\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"button\", 8);\n    i0.ɵɵelementStart(7, \"mat-icon\");\n    i0.ɵɵtext(8, \"clear\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const user_r1 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(user_r1.nickname);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", true);\n  }\n}\n\nconst _c1 = \".mat-dialog-content[_ngcontent-%COMP%] {\\r\\n  padding: 10px;\\r\\n\\r\\n}\\r\\n.mat-icon[_ngcontent-%COMP%] {\\r\\n  margin-left: 5px;\\r\\n  margin-right: 5px;\\r\\n}\\r\\nspan[_ngcontent-%COMP%] {\\r\\n  margin-left: 15px;\\r\\n}\\r\\n.mat-divider[_ngcontent-%COMP%] {\\r\\n  padding-top: 10px;\\r\\n  padding-bottom: 5px;\\r\\n  margin-left: 20px;\\r\\n  margin-right: 20px;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lc3NhZ2UtbGlzdC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsYUFBYTs7QUFFZjtBQUNBO0VBQ0UsZ0JBQWdCO0VBQ2hCLGlCQUFpQjtBQUNuQjtBQUNBO0VBQ0UsaUJBQWlCO0FBQ25CO0FBQ0E7RUFDRSxpQkFBaUI7RUFDakIsbUJBQW1CO0VBQ25CLGlCQUFpQjtFQUNqQixrQkFBa0I7QUFDcEIiLCJmaWxlIjoibWVzc2FnZS1saXN0LmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIubWF0LWRpYWxvZy1jb250ZW50IHtcclxuICBwYWRkaW5nOiAxMHB4O1xyXG5cclxufVxyXG4ubWF0LWljb24ge1xyXG4gIG1hcmdpbi1sZWZ0OiA1cHg7XHJcbiAgbWFyZ2luLXJpZ2h0OiA1cHg7XHJcbn1cclxuc3BhbiB7XHJcbiAgbWFyZ2luLWxlZnQ6IDE1cHg7XHJcbn1cclxuLm1hdC1kaXZpZGVyIHtcclxuICBwYWRkaW5nLXRvcDogMTBweDtcclxuICBwYWRkaW5nLWJvdHRvbTogNXB4O1xyXG4gIG1hcmdpbi1sZWZ0OiAyMHB4O1xyXG4gIG1hcmdpbi1yaWdodDogMjBweDtcclxufVxyXG4iXX0= */\";\nexport class MessageListComponent {\n  constructor(dataHandlerService, roomService, messageService, dialog, tokenStorageService, notificationService, imageService) {\n    this.dataHandlerService = dataHandlerService;\n    this.roomService = roomService;\n    this.messageService = messageService;\n    this.dialog = dialog;\n    this.tokenStorageService = tokenStorageService;\n    this.notificationService = notificationService;\n    this.imageService = imageService;\n    this.selfMessage = \"ks-self\";\n    this.fromMessage = \"ks-from\";\n    this.userImages = new Map();\n    this.disableScrollDown = false;\n  }\n\n  ngOnInit() {\n    this.userImages = this.imageService.userImages;\n    this.currentUserId = this.tokenStorageService.getUser().user_id;\n    console.log(\"TEMP userId=\" + this.currentUserId); //this.users = this.dataHandlerService.getUserList();\n    //this.messages = this.dataHandlerService.getMessages();\n\n    this.roomService.selectedRoom.subscribe(room => {\n      this.activeRoom = room;\n      this.users = room.users;\n      this.messageService.getAllMessages(this.activeRoom.id);\n      this.imageService.getUsersImagesFromRoom(room);\n    });\n    this.messageService.subjectMessages.subscribe(messages => {\n      this.messages = messages;\n      this.disableScrollDown = false;\n      this.scrollToBottom();\n    });\n    this.messageService.subjectMessage.subscribe(message => {\n      if (this.activeRoom.id === message.room_id) {\n        this.messages.push(message);\n        this.disableScrollDown = false;\n        this.scrollToBottom();\n        console.log(\"Новое сообщение из текущей комнаты \" + message.room_id);\n      } else {\n        console.log(\"Новое сообщение из комнаты \" + message.room_id);\n        this.notificationService.showSnackBar(\"Новое сообщение из комнаты \" + message.room_id);\n      }\n    });\n    this.scrollToBottom();\n  } //*ngIf=\"getSenderImage(message.sender_id) | async; let image\"\n\n\n  ngAfterViewChecked() {\n    this.scrollToBottom();\n  }\n\n  formatImage(img) {\n    if (img == null) {\n      return null;\n    }\n\n    return 'data:image/jpeg;base64,' + img;\n  }\n\n  onReceivedImage(data) {\n    return data.imageBytes;\n  }\n\n  getSenderImage(senderId) {\n    return this.imageService.getUserImage(senderId).pipe(map(val => 'data:image/jpeg;base64,' + val.imageBytes));\n  }\n\n  onScroll() {\n    let element = this.myScrollContainer.nativeElement;\n    let atBottom = element.scrollHeight - element.scrollTop === element.clientHeight;\n    this.disableScrollDown = !(this.disableScrollDown && atBottom);\n  }\n\n  scrollToBottom() {\n    if (this.disableScrollDown) {\n      return;\n    }\n\n    try {\n      this.myScrollContainer.nativeElement.scrollTop = this.myScrollContainer.nativeElement.scrollHeight;\n    } catch (err) {}\n  }\n\n  openDialogMembers() {\n    const dialogRef = this.dialog.open(DialogMembers, {\n      //width: '250px',\n      // height: '50%',\n      data: {\n        room: this.activeRoom,\n        users: this.users\n      }\n    });\n    dialogRef.afterClosed().subscribe(result => {\n      console.log('The dialog was closed');\n    });\n  }\n\n  sendMessage() {\n    if (this.newMessageText && this.newMessageText.length > 0) {\n      this.messageService.createMessage(this.activeRoom.id, this.newMessageText);\n      this.newMessageText = '';\n    } else {\n      console.log(\"Сообщение пустое!\");\n    }\n  }\n\n}\n\nMessageListComponent.ɵfac = function MessageListComponent_Factory(t) {\n  return new (t || MessageListComponent)(i0.ɵɵdirectiveInject(i1.DataHandlerService), i0.ɵɵdirectiveInject(i2.RoomService), i0.ɵɵdirectiveInject(i3.MessageService), i0.ɵɵdirectiveInject(i4.MatDialog), i0.ɵɵdirectiveInject(i5.TokenStorageService), i0.ɵɵdirectiveInject(i6.NotificationService), i0.ɵɵdirectiveInject(i7.ImageUploadService));\n};\n\nMessageListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: MessageListComponent,\n  selectors: [[\"app-message-list\"]],\n  viewQuery: function MessageListComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.myScrollContainer = _t.first);\n    }\n  },\n  decls: 30,\n  vars: 10,\n  consts: [[1, \"ks-messages\", \"ks-messenger__messages\"], [1, \"ks-header\"], [1, \"ks-description\"], [1, \"ks-name\"], [1, \"ks-amount\"], [\"class\", \"ks-controls\", 4, \"ngIf\"], [\"data-reduce-height\", \".ks-footer\", \"tabindex\", \"0\", 1, \"ks-body\", \"ks-scrollable\", \"jspScrollable\", 2, \"height\", \"480px\", \"overflow-y\", \"scroll\", \"overflow-x\", \"hidden\", \"padding\", \"0px\", \"width\", \"701px\", 3, \"scroll\"], [\"scrollMe\", \"\"], [1, \"jspContainer\", 2, \"width\", \"601px\"], [1, \"jspPane\", 2, \"padding\", \"0px\", \"top\", \"0px\", \"width\", \"691px\"], [1, \"ks-items\"], [\"class\", \"ks-separator\", 4, \"ngIf\"], [3, \"class\", 4, \"ngFor\", \"ngForOf\"], [1, \"jspVerticalBar\"], [1, \"jspCap\", \"jspCapTop\"], [1, \"jspTrack\", 2, \"height\", \"390px\"], [1, \"jspDrag\", 2, \"height\", \"206px\"], [1, \"jspDragTop\"], [1, \"jspDragBottom\"], [1, \"jspCap\", \"jspCapBottom\"], [1, \"ks-footer\"], [\"hintLabel\", \"\\u041A\\u0430\\u043A \\u0432\\u0430\\u0448\\u0438 \\u0434\\u0435\\u043B\\u0430?\", 1, \"form-control\"], [\"matInput\", \"\", 3, \"disabled\", \"cdkTextareaAutosize\", \"matTextareaAutosize\", \"ngModel\", \"ngModelChange\"], [1, \"ks-controls\"], [\"mat-raised-button\", \"\", 1, \"btn\", \"btn-primary\", 3, \"disabled\", \"click\"], [\"mat-icon-button\", \"\", 3, \"click\"], [1, \"ks-separator\"], [1, \"ks-avatar\", \"ks-offline\"], [\"height\", \"36\", \"alt\", \"user image\", \"width\", \"36\", 1, \"rounded-circle\", 3, \"src\"], [1, \"ks-body\"], [1, \"ks-datetime\"], [1, \"ks-message\"]],\n  template: function MessageListComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelementStart(1, \"div\", 1);\n      i0.ɵɵelementStart(2, \"div\", 2);\n      i0.ɵɵelementStart(3, \"div\", 3);\n      i0.ɵɵtext(4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"div\", 4);\n      i0.ɵɵtext(6);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(7, MessageListComponent_div_7_Template, 4, 0, \"div\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"div\", 6, 7);\n      i0.ɵɵlistener(\"scroll\", function MessageListComponent_Template_div_scroll_8_listener() {\n        return ctx.onScroll();\n      });\n      i0.ɵɵelementStart(10, \"div\", 8);\n      i0.ɵɵelementStart(11, \"div\", 9);\n      i0.ɵɵelementStart(12, \"ul\", 10);\n      i0.ɵɵtemplate(13, MessageListComponent_li_13_Template, 2, 0, \"li\", 11);\n      i0.ɵɵtemplate(14, MessageListComponent_li_14_Template, 12, 10, \"li\", 12);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"div\", 13);\n      i0.ɵɵelement(16, \"div\", 14);\n      i0.ɵɵelementStart(17, \"div\", 15);\n      i0.ɵɵelementStart(18, \"div\", 16);\n      i0.ɵɵelement(19, \"div\", 17);\n      i0.ɵɵelement(20, \"div\", 18);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(21, \"div\", 19);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(22, \"div\", 20);\n      i0.ɵɵelementStart(23, \"mat-form-field\", 21);\n      i0.ɵɵelementStart(24, \"mat-label\");\n      i0.ɵɵtext(25, \"\\u0422\\u0435\\u043A\\u0441\\u0442 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u044F\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(26, \"textarea\", 22);\n      i0.ɵɵlistener(\"ngModelChange\", function MessageListComponent_Template_textarea_ngModelChange_26_listener($event) {\n        return ctx.newMessageText = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(27, \"div\", 23);\n      i0.ɵɵelementStart(28, \"button\", 24);\n      i0.ɵɵlistener(\"click\", function MessageListComponent_Template_button_click_28_listener() {\n        return ctx.sendMessage();\n      });\n      i0.ɵɵtext(29, \"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate(ctx.activeRoom ? ctx.activeRoom.name : \"\\u0418\\u043C\\u044F \\u043A\\u043E\\u043C\\u043D\\u0430\\u0442\\u044B\");\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\"\", ctx.activeRoom ? ctx.activeRoom.users.length : \"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E\", \" \\u0443\\u0447\\u0430\\u0441\\u0442\\u043D\\u0438\\u043A\\u043E\\u0432\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.activeRoom);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngIf\", !ctx.activeRoom);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.messages);\n      i0.ɵɵadvance(12);\n      i0.ɵɵproperty(\"disabled\", !ctx.activeRoom)(\"cdkTextareaAutosize\", true)(\"matTextareaAutosize\", false)(\"ngModel\", ctx.newMessageText);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"disabled\", !ctx.activeRoom);\n    }\n  },\n  directives: [i8.NgIf, i8.NgForOf, i9.MatFormField, i9.MatLabel, i10.MatInput, i11.CdkTextareaAutosize, i10.MatTextareaAutosize, i12.DefaultValueAccessor, i12.NgControlStatus, i12.NgModel, i13.MatButton, i14.MatIcon],\n  pipes: [i8.DatePipe],\n  styles: [_c1]\n});\nexport class DialogMembers {\n  constructor(dialogRef, data, roomService) {\n    this.dialogRef = dialogRef;\n    this.data = data;\n    this.roomService = roomService;\n  }\n\n  addUser() {\n    this.roomService.addUserToRoom(this.nickname, this.data.room.id);\n  }\n\n}\n\nDialogMembers.ɵfac = function DialogMembers_Factory(t) {\n  return new (t || DialogMembers)(i0.ɵɵdirectiveInject(i4.MatDialogRef), i0.ɵɵdirectiveInject(MAT_DIALOG_DATA), i0.ɵɵdirectiveInject(i2.RoomService));\n};\n\nDialogMembers.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DialogMembers,\n  selectors: [[\"dialog-members\"]],\n  decls: 20,\n  vars: 3,\n  consts: [[\"mat-dialog-title\", \"\"], [1, \"mat-typography\"], [4, \"ngFor\", \"ngForOf\"], [\"hintLabel\", \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"], [\"matInput\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"mat-raised-button\", \"\", 1, \"add-user-button\", 3, \"click\"], [\"align\", \"end\"], [\"mat-button\", \"\", 1, \"close-button\", 3, \"mat-dialog-close\"], [\"mat-icon-button\", \"\", 2, \"position\", \"absolute\", \"right\", \"20px\", 3, \"disabled\"]],\n  template: function DialogMembers_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h2\", 0);\n      i0.ɵɵtext(1);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"mat-dialog-content\", 1);\n      i0.ɵɵelementStart(3, \"mat-list\");\n      i0.ɵɵtext(4, \"\\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u0438: \");\n      i0.ɵɵtemplate(5, DialogMembers_mat_list_item_5_Template, 9, 2, \"mat-list-item\", 2);\n      i0.ɵɵelement(6, \"mat-divider\");\n      i0.ɵɵelementStart(7, \"mat-list-item\");\n      i0.ɵɵelementStart(8, \"mat-form-field\", 3);\n      i0.ɵɵelementStart(9, \"mat-label\");\n      i0.ɵɵtext(10, \"\\u041D\\u0438\\u043A\\u043D\\u0435\\u0439\\u043C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"input\", 4);\n      i0.ɵɵlistener(\"ngModelChange\", function DialogMembers_Template_input_ngModelChange_11_listener($event) {\n        return ctx.nickname = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"span\");\n      i0.ɵɵelementStart(13, \"button\", 5);\n      i0.ɵɵlistener(\"click\", function DialogMembers_Template_button_click_13_listener() {\n        return ctx.addUser();\n      });\n      i0.ɵɵelementStart(14, \"mat-icon\");\n      i0.ɵɵtext(15, \"add_circle_outline\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(16, \" \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(17, \"mat-dialog-actions\", 6);\n      i0.ɵɵelementStart(18, \"button\", 7);\n      i0.ɵɵtext(19, \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵtextInterpolate1(\"\\u041D\\u0430\\u0441\\u0442\\u0440\\u043E\\u0439\\u043A\\u0438 \\u043A\\u043E\\u043C\\u043D\\u0430\\u0442\\u044B \", ctx.data.room.name, \"\");\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.data.users);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngModel\", ctx.nickname);\n    }\n  },\n  directives: [i4.MatDialogTitle, i4.MatDialogContent, i15.MatList, i8.NgForOf, i16.MatDivider, i15.MatListItem, i9.MatFormField, i9.MatLabel, i10.MatInput, i12.DefaultValueAccessor, i12.NgControlStatus, i12.NgModel, i13.MatButton, i14.MatIcon, i4.MatDialogActions, i4.MatDialogClose],\n  styles: [_c1]\n});","map":{"version":3,"sources":["D:\\Projects\\AngularProjects\\WebChat\\src\\app\\views\\message-list\\message-list.component.ts","D:\\Projects\\AngularProjects\\WebChat\\src\\app\\views\\message-list\\message-list.component.html","D:\\Projects\\AngularProjects\\WebChat\\src\\app\\views\\message-list\\dialog-members.html"],"names":[],"mappings":"AAMA,SAAQ,eAAR,QAAuD,0BAAvD;AAKA,SAAgB,GAAhB,QAA0B,gBAA1B;;;;;;;;;;;;;;;;;;;;;;;;ACLI,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,KAAA,EAAA,EAAA;AACE,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,QAAA,EAAA,EAAA;AAAwB,IAAA,EAAA,CAAA,UAAA,CAAA,OAAA,EAAA,SAAA,2DAAA,GAAA;AAAA,MAAA,EAAA,CAAA,aAAA,CAAA,GAAA;AAAA,YAAA,MAAA,GAAA,EAAA,CAAA,aAAA,EAAA;AAAA,aAAA,MAAA,CAAA,iBAAA,EAAA;AAAA,KAAA;AACtB,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,UAAA;AAAU,IAAA,EAAA,CAAA,MAAA,CAAA,CAAA,EAAA,QAAA;AAAM,IAAA,EAAA,CAAA,YAAA;AAClB,IAAA,EAAA,CAAA,YAAA;AACF,IAAA,EAAA,CAAA,YAAA;;;;;;AASM,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,IAAA,EAAA,EAAA;AAA6C,IAAA,EAAA,CAAA,MAAA,CAAA,CAAA,EAAA,mGAAA;AAAiB,IAAA,EAAA,CAAA,YAAA;;;;;;AAC9D,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,IAAA;AACC,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,MAAA,EAAA,EAAA;AACC,IAAA,EAAA,CAAA,SAAA,CAAA,CAAA,EAAA,KAAA,EAAA,EAAA;AAGA,IAAA,EAAA,CAAA,YAAA;AACA,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,KAAA,EAAA,EAAA;AACE,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,KAAA,EAAA,CAAA;AACE,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,MAAA,EAAA,CAAA;AAAsB,IAAA,EAAA,CAAA,MAAA,CAAA,CAAA;AAAgK,IAAA,EAAA,CAAA,YAAA;AACtL,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,MAAA,EAAA,EAAA;AAA0B,IAAA,EAAA,CAAA,MAAA,CAAA,CAAA;;AAAsC,IAAA,EAAA,CAAA,YAAA;AAClE,IAAA,EAAA,CAAA,YAAA;AACA,IAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,KAAA,EAAA,EAAA;AAAwB,IAAA,EAAA,CAAA,MAAA,CAAA,EAAA;AAAgB,IAAA,EAAA,CAAA,YAAA;AAC1C,IAAA,EAAA,CAAA,YAAA;AACF,IAAA,EAAA,CAAA,YAAA;;;;;;;AAbI,IAAA,EAAA,CAAA,sBAAA,CAAA,UAAA,EAAA,UAAA,CAAA,SAAA,KAAA,MAAA,CAAA,aAAA,GAAA,MAAA,CAAA,WAAA,GAAA,MAAA,CAAA,WAAA,EAAA,EAAA;AAGG,IAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,IAAA,EAAA,CAAA,UAAA,CAAA,KAAA,EAAA,MAAA,CAAA,WAAA,CAAA,MAAA,CAAA,UAAA,IAAA,IAAA,GAAA,IAAA,GAAA,MAAA,CAAA,UAAA,CAAA,GAAA,CAAA,UAAA,CAAA,SAAA,CAAA,KAAA,uGAAA,EAAA,EAAA,CAAA,aAAA;AAKqB,IAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,IAAA,EAAA,CAAA,iBAAA,CAAA,MAAA,CAAA,cAAA,CAAA,uBAAA,CAAA,MAAA,CAAA,UAAA,EAAA,UAAA,CAAA,SAAA,IAAA,CAAA,OAAA,GAAA,MAAA,CAAA,cAAA,CAAA,uBAAA,CAAA,MAAA,CAAA,UAAA,EAAA,UAAA,CAAA,SAAA,CAAA,KAAA,IAAA,GAAA,IAAA,GAAA,OAAA,CAAA,QAAA,GAAA,EAAA;AACI,IAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,IAAA,EAAA,CAAA,iBAAA,CAAA,EAAA,CAAA,WAAA,CAAA,CAAA,EAAA,CAAA,EAAA,UAAA,CAAA,WAAA,EAAA,OAAA,CAAA;AAEJ,IAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,IAAA,EAAA,CAAA,iBAAA,CAAA,UAAA,CAAA,IAAA;;;;;;AC5BlC,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,eAAA;AACE,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,UAAA;AAAU,IAAA,EAAA,CAAA,MAAA,CAAA,CAAA,EAAA,MAAA;AAAI,IAAA,EAAA,CAAA,YAAA;AAAW,IAAA,EAAA,CAAA,MAAA,CAAA,CAAA,EAAA,2BAAA;AAAU,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,GAAA;AAAG,IAAA,EAAA,CAAA,MAAA,CAAA,CAAA;AAAiB,IAAA,EAAA,CAAA,YAAA;AACvD,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,QAAA,EAAA,CAAA;AACE,IAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,UAAA;AAAU,IAAA,EAAA,CAAA,MAAA,CAAA,CAAA,EAAA,OAAA;AAAK,IAAA,EAAA,CAAA,YAAA;AACjB,IAAA,EAAA,CAAA,YAAA;AACF,IAAA,EAAA,CAAA,YAAA;;;;;AAJwC,IAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,IAAA,EAAA,CAAA,iBAAA,CAAA,OAAA,CAAA,QAAA;AACd,IAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,IAAA,EAAA,CAAA,UAAA,CAAA,UAAA,EAAA,IAAA;;;;;AFc9B,OAAM,MAAO,oBAAP,CAA2B;AAe/B,EAAA,WAAA,CAAoB,kBAApB,EACoB,WADpB,EAEmB,cAFnB,EAGmB,MAHnB,EAIoB,mBAJpB,EAKoB,mBALpB,EAMmB,YANnB,EAMmD;AAN/B,SAAA,kBAAA,GAAA,kBAAA;AACA,SAAA,WAAA,GAAA,WAAA;AACD,SAAA,cAAA,GAAA,cAAA;AACA,SAAA,MAAA,GAAA,MAAA;AACC,SAAA,mBAAA,GAAA,mBAAA;AACA,SAAA,mBAAA,GAAA,mBAAA;AACD,SAAA,YAAA,GAAA,YAAA;AAfnB,SAAA,WAAA,GAAsB,SAAtB;AACA,SAAA,WAAA,GAAsB,SAAtB;AACA,SAAA,UAAA,GAAgC,IAAI,GAAJ,EAAhC;AAIA,SAAA,iBAAA,GAAoB,KAApB;AAUC;;AAED,EAAA,QAAQ,GAAA;AACN,SAAK,UAAL,GAAkB,KAAK,YAAL,CAAkB,UAApC;AACA,SAAK,aAAL,GAAqB,KAAK,mBAAL,CAAyB,OAAzB,GAAmC,OAAxD;AACA,IAAA,OAAO,CAAC,GAAR,CAAY,iBAAe,KAAK,aAAhC,EAHM,CAIN;AACA;;AACA,SAAK,WAAL,CAAiB,YAAjB,CAA8B,SAA9B,CAAwC,IAAI,IAAG;AAC7C,WAAK,UAAL,GAAkB,IAAlB;AACA,WAAK,KAAL,GAAa,IAAI,CAAC,KAAlB;AACA,WAAK,cAAL,CAAoB,cAApB,CAAmC,KAAK,UAAL,CAAgB,EAAnD;AACA,WAAK,YAAL,CAAkB,sBAAlB,CAAyC,IAAzC;AACD,KALD;AAMA,SAAK,cAAL,CAAoB,eAApB,CAAoC,SAApC,CAA+C,QAAD,IAAa;AACzD,WAAK,QAAL,GAAgB,QAAhB;AACA,WAAK,iBAAL,GAAyB,KAAzB;AACA,WAAK,cAAL;AACD,KAJD;AAKA,SAAK,cAAL,CAAoB,cAApB,CAAmC,SAAnC,CAA8C,OAAD,IAAY;AACvD,UAAI,KAAK,UAAL,CAAgB,EAAhB,KAAuB,OAAO,CAAC,OAAnC,EAA4C;AAC1C,aAAK,QAAL,CAAc,IAAd,CAAmB,OAAnB;AACA,aAAK,iBAAL,GAAyB,KAAzB;AACA,aAAK,cAAL;AACA,QAAA,OAAO,CAAC,GAAR,CAAY,wCAAwC,OAAO,CAAC,OAA5D;AACD,OALD,MAKO;AACL,QAAA,OAAO,CAAC,GAAR,CAAY,gCAAgC,OAAO,CAAC,OAApD;AACA,aAAK,mBAAL,CAAyB,YAAzB,CAAsC,gCAAgC,OAAO,CAAC,OAA9E;AACD;AACF,KAVD;AAWA,SAAK,cAAL;AACD,GArD8B,CAsD/B;;;AAEA,EAAA,kBAAkB,GAAA;AAChB,SAAK,cAAL;AACD;;AAED,EAAA,WAAW,CAAC,GAAD,EAAS;AAClB,QAAI,GAAG,IAAI,IAAX,EAAiB;AACf,aAAO,IAAP;AACD;;AACD,WAAO,4BAA4B,GAAnC;AACD;;AAED,EAAA,eAAe,CAAC,IAAD,EAAW;AACxB,WAAO,IAAI,CAAC,UAAZ;AACD;;AAED,EAAA,cAAc,CAAC,QAAD,EAAiB;AAC7B,WAAO,KAAK,YAAL,CAAkB,YAAlB,CAA+B,QAA/B,EAAyC,IAAzC,CACL,GAAG,CAAC,GAAG,IAAK,4BAA2B,GAAG,CAAC,UAAxC,CADE,CAAP;AAGD;;AAID,EAAA,QAAQ,GAAA;AACN,QAAI,OAAO,GAAG,KAAK,iBAAL,CAAuB,aAArC;AACA,QAAI,QAAQ,GAAG,OAAO,CAAC,YAAR,GAAuB,OAAO,CAAC,SAA/B,KAA6C,OAAO,CAAC,YAApE;AACA,SAAK,iBAAL,GAAyB,EAAE,KAAK,iBAAL,IAA0B,QAA5B,CAAzB;AACD;;AAED,EAAA,cAAc,GAAA;AACZ,QAAI,KAAK,iBAAT,EAA4B;AAC1B;AACD;;AACD,QAAI;AACF,WAAK,iBAAL,CAAuB,aAAvB,CAAqC,SAArC,GAAiD,KAAK,iBAAL,CAAuB,aAAvB,CAAqC,YAAtF;AACD,KAFD,CAEE,OAAM,GAAN,EAAW,CAAG;AACjB;;AAED,EAAA,iBAAiB,GAAA;AACf,UAAM,SAAS,GAAG,KAAK,MAAL,CAAY,IAAZ,CAAiB,aAAjB,EAAgC;AAChD;AACD;AACC,MAAA,IAAI,EAAE;AAAC,QAAA,IAAI,EAAE,KAAK,UAAZ;AAAwB,QAAA,KAAK,EAAE,KAAK;AAApC;AAH0C,KAAhC,CAAlB;AAMA,IAAA,SAAS,CAAC,WAAV,GAAwB,SAAxB,CAAkC,MAAM,IAAG;AACzC,MAAA,OAAO,CAAC,GAAR,CAAY,uBAAZ;AACD,KAFD;AAGD;;AAED,EAAA,WAAW,GAAA;AACT,QAAI,KAAK,cAAL,IAAuB,KAAK,cAAL,CAAoB,MAApB,GAA2B,CAAtD,EAAyD;AACrD,WAAK,cAAL,CAAoB,aAApB,CAAkC,KAAK,UAAL,CAAgB,EAAlD,EAAsD,KAAK,cAA3D;AACA,WAAK,cAAL,GAAsB,EAAtB;AACH,KAHD,MAGO;AACL,MAAA,OAAO,CAAC,GAAR,CAAY,mBAAZ;AACD;AACF;;AAjH8B;;;mBAApB,oB,EAAoB,EAAA,CAAA,iBAAA,CAAA,EAAA,CAAA,kBAAA,C,EAAA,EAAA,CAAA,iBAAA,CAAA,EAAA,CAAA,WAAA,C,EAAA,EAAA,CAAA,iBAAA,CAAA,EAAA,CAAA,cAAA,C,EAAA,EAAA,CAAA,iBAAA,CAAA,EAAA,CAAA,SAAA,C,EAAA,EAAA,CAAA,iBAAA,CAAA,EAAA,CAAA,mBAAA,C,EAAA,EAAA,CAAA,iBAAA,CAAA,EAAA,CAAA,mBAAA,C,EAAA,EAAA,CAAA,iBAAA,CAAA,EAAA,CAAA,kBAAA,C;AAAA,C;;;QAApB,oB;AAAoB,EAAA,SAAA,EAAA,CAAA,CAAA,kBAAA,CAAA,C;AAAA,EAAA,SAAA,EAAA,SAAA,0BAAA,CAAA,EAAA,EAAA,GAAA,EAAA;AAAA,QAAA,EAAA,GAAA,CAAA,EAAA;;;;;;;;;;;;;;;ACnBjC,MAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,KAAA,EAAA,CAAA;AACE,MAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,KAAA,EAAA,CAAA;AACE,MAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,KAAA,EAAA,CAAA;AACE,MAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,KAAA,EAAA,CAAA;AAAqB,MAAA,EAAA,CAAA,MAAA,CAAA,CAAA;AAAgD,MAAA,EAAA,CAAA,YAAA;AACrE,MAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,KAAA,EAAA,CAAA;AAAuB,MAAA,EAAA,CAAA,MAAA,CAAA,CAAA;AAAkE,MAAA,EAAA,CAAA,YAAA;AAC3F,MAAA,EAAA,CAAA,YAAA;AACA,MAAA,EAAA,CAAA,UAAA,CAAA,CAAA,EAAA,mCAAA,EAAA,CAAA,EAAA,CAAA,EAAA,KAAA,EAAA,CAAA;AAKF,MAAA,EAAA,CAAA,YAAA;AACA,MAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,KAAA,EAAA,CAAA,EAAA,CAAA;AAG4B,MAAA,EAAA,CAAA,UAAA,CAAA,QAAA,EAAA,SAAA,mDAAA,GAAA;AAAA,eAAU,GAAA,CAAA,QAAA,EAAV;AAAoB,OAApB;AAC1B,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,KAAA,EAAA,CAAA;AACE,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,KAAA,EAAA,CAAA;AACE,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA;AACE,MAAA,EAAA,CAAA,UAAA,CAAA,EAAA,EAAA,mCAAA,EAAA,CAAA,EAAA,CAAA,EAAA,IAAA,EAAA,EAAA;AACA,MAAA,EAAA,CAAA,UAAA,CAAA,EAAA,EAAA,mCAAA,EAAA,EAAA,EAAA,EAAA,EAAA,IAAA,EAAA,EAAA;AAcF,MAAA,EAAA,CAAA,YAAA;AACF,MAAA,EAAA,CAAA,YAAA;AACA,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,KAAA,EAAA,EAAA;AACE,MAAA,EAAA,CAAA,SAAA,CAAA,EAAA,EAAA,KAAA,EAAA,EAAA;AACA,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,KAAA,EAAA,EAAA;AACE,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,KAAA,EAAA,EAAA;AACE,MAAA,EAAA,CAAA,SAAA,CAAA,EAAA,EAAA,KAAA,EAAA,EAAA;AACA,MAAA,EAAA,CAAA,SAAA,CAAA,EAAA,EAAA,KAAA,EAAA,EAAA;AACF,MAAA,EAAA,CAAA,YAAA;AACF,MAAA,EAAA,CAAA,YAAA;AACA,MAAA,EAAA,CAAA,SAAA,CAAA,EAAA,EAAA,KAAA,EAAA,EAAA;AACF,MAAA,EAAA,CAAA,YAAA;AACF,MAAA,EAAA,CAAA,YAAA;AACF,MAAA,EAAA,CAAA,YAAA;AACA,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,KAAA,EAAA,EAAA;AACE,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,gBAAA,EAAA,EAAA;AACI,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,WAAA;AAAW,MAAA,EAAA,CAAA,MAAA,CAAA,EAAA,EAAA,uFAAA;AAAe,MAAA,EAAA,CAAA,YAAA;AAC1B,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,UAAA,EAAA,EAAA;AAAwG,MAAA,EAAA,CAAA,UAAA,CAAA,eAAA,EAAA,SAAA,gEAAA,CAAA,MAAA,EAAA;AAAA,eAAA,GAAA,CAAA,cAAA,GAAA,MAAA;AAAA,OAAA;AAA6B,MAAA,EAAA,CAAA,YAAA;AACzI,MAAA,EAAA,CAAA,YAAA;AACA,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,KAAA,EAAA,EAAA;AACE,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,QAAA,EAAA,EAAA;AAA2E,MAAA,EAAA,CAAA,UAAA,CAAA,OAAA,EAAA,SAAA,sDAAA,GAAA;AAAA,eAAS,GAAA,CAAA,WAAA,EAAT;AAAsB,OAAtB;AAAwB,MAAA,EAAA,CAAA,MAAA,CAAA,EAAA,EAAA,wDAAA;AAAS,MAAA,EAAA,CAAA,YAAA;AAC9G,MAAA,EAAA,CAAA,YAAA;AACF,MAAA,EAAA,CAAA,YAAA;AACF,MAAA,EAAA,CAAA,YAAA;;;;AAtD2B,MAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,MAAA,EAAA,CAAA,iBAAA,CAAA,GAAA,CAAA,UAAA,GAAA,GAAA,CAAA,UAAA,CAAA,IAAA,GAAA,+DAAA;AACE,MAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,MAAA,EAAA,CAAA,kBAAA,CAAA,EAAA,EAAA,GAAA,CAAA,UAAA,GAAA,GAAA,CAAA,UAAA,CAAA,KAAA,CAAA,MAAA,GAAA,8DAAA,EAAA,+DAAA;AAEnB,MAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,MAAA,EAAA,CAAA,UAAA,CAAA,MAAA,EAAA,GAAA,CAAA,UAAA;AAaK,MAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,MAAA,EAAA,CAAA,UAAA,CAAA,MAAA,EAAA,CAAA,GAAA,CAAA,UAAA;AACoG,MAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,MAAA,EAAA,CAAA,UAAA,CAAA,SAAA,EAAA,GAAA,CAAA,QAAA;AA+BjG,MAAA,EAAA,CAAA,SAAA,CAAA,EAAA;AAAA,MAAA,EAAA,CAAA,UAAA,CAAA,UAAA,EAAA,CAAA,GAAA,CAAA,UAAA,EAAwB,qBAAxB,EAAwB,IAAxB,EAAwB,qBAAxB,EAAwB,KAAxB,EAAwB,SAAxB,EAAwB,GAAA,CAAA,cAAxB;AAGc,MAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,MAAA,EAAA,CAAA,UAAA,CAAA,UAAA,EAAA,CAAA,GAAA,CAAA,UAAA;;;;;;;ADyFhC,OAAM,MAAO,aAAP,CAAoB;AAGxB,EAAA,WAAA,CACS,SADT,EAEkC,IAFlC,EAGU,WAHV,EAGkC;AAFzB,SAAA,SAAA,GAAA,SAAA;AACyB,SAAA,IAAA,GAAA,IAAA;AACxB,SAAA,WAAA,GAAA,WAAA;AAA4B;;AAEtC,EAAA,OAAO,GAAA;AACL,SAAK,WAAL,CAAiB,aAAjB,CAA+B,KAAK,QAApC,EAA8C,KAAK,IAAL,CAAU,IAAV,CAAe,EAA7D;AACD;;AAVuB;;;mBAAb,a,EAAa,EAAA,CAAA,iBAAA,CAAA,EAAA,CAAA,YAAA,C,EAAA,EAAA,CAAA,iBAAA,CAKd,eALc,C,EAKC,EAAA,CAAA,iBAAA,CAAA,EAAA,CAAA,WAAA,C;AAAA,C;;;QALd,a;AAAa,EAAA,SAAA,EAAA,CAAA,CAAA,gBAAA,CAAA,C;AAAA,EAAA,KAAA,EAAA,E;AAAA,EAAA,IAAA,EAAA,C;AAAA,EAAA,MAAA,EAAA,CAAA,CAAA,kBAAA,EAAA,EAAA,CAAA,EAAA,CAAA,CAAA,EAAA,gBAAA,CAAA,EAAA,CAAA,CAAA,EAAA,OAAA,EAAA,SAAA,CAAA,EAAA,CAAA,WAAA,EAAA,2HAAA,CAAA,EAAA,CAAA,UAAA,EAAA,EAAA,EAAA,CAAA,EAAA,SAAA,EAAA,eAAA,CAAA,EAAA,CAAA,mBAAA,EAAA,EAAA,EAAA,CAAA,EAAA,iBAAA,EAAA,CAAA,EAAA,OAAA,CAAA,EAAA,CAAA,OAAA,EAAA,KAAA,CAAA,EAAA,CAAA,YAAA,EAAA,EAAA,EAAA,CAAA,EAAA,cAAA,EAAA,CAAA,EAAA,kBAAA,CAAA,EAAA,CAAA,iBAAA,EAAA,EAAA,EAAA,CAAA,EAAA,UAAA,EAAA,UAAA,EAAA,OAAA,EAAA,MAAA,EAAA,CAAA,EAAA,UAAA,CAAA,C;AAAA,EAAA,QAAA,EAAA,SAAA,sBAAA,CAAA,EAAA,EAAA,GAAA,EAAA;AAAA,QAAA,EAAA,GAAA,CAAA,EAAA;AE/I1B,MAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,IAAA,EAAA,CAAA;AAAqB,MAAA,EAAA,CAAA,MAAA,CAAA,CAAA;AAAoC,MAAA,EAAA,CAAA,YAAA;AACzD,MAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,oBAAA,EAAA,CAAA;AACE,MAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,UAAA;AAAU,MAAA,EAAA,CAAA,MAAA,CAAA,CAAA,EAAA,4EAAA;AACR,MAAA,EAAA,CAAA,UAAA,CAAA,CAAA,EAAA,sCAAA,EAAA,CAAA,EAAA,CAAA,EAAA,eAAA,EAAA,CAAA;AAMA,MAAA,EAAA,CAAA,SAAA,CAAA,CAAA,EAAA,aAAA;AACA,MAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,eAAA;AACE,MAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,gBAAA,EAAA,CAAA;AACE,MAAA,EAAA,CAAA,cAAA,CAAA,CAAA,EAAA,WAAA;AAAW,MAAA,EAAA,CAAA,MAAA,CAAA,EAAA,EAAA,qHAAA;AAAoB,MAAA,EAAA,CAAA,YAAA;AAC/B,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,OAAA,EAAA,CAAA;AAAgB,MAAA,EAAA,CAAA,UAAA,CAAA,eAAA,EAAA,SAAA,sDAAA,CAAA,MAAA,EAAA;AAAA,eAAA,GAAA,CAAA,QAAA,GAAA,MAAA;AAAA,OAAA;AAAhB,MAAA,EAAA,CAAA,YAAA;AACF,MAAA,EAAA,CAAA,YAAA;AACA,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,MAAA;AACE,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,QAAA,EAAA,CAAA;AAAkD,MAAA,EAAA,CAAA,UAAA,CAAA,OAAA,EAAA,SAAA,+CAAA,GAAA;AAAA,eAAS,GAAA,CAAA,OAAA,EAAT;AAAkB,OAAlB;AAChD,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,UAAA;AAAU,MAAA,EAAA,CAAA,MAAA,CAAA,EAAA,EAAA,oBAAA;AAAkB,MAAA,EAAA,CAAA,YAAA;AAC5B,MAAA,EAAA,CAAA,MAAA,CAAA,EAAA,EAAA,oDAAA;AACF,MAAA,EAAA,CAAA,YAAA;AACF,MAAA,EAAA,CAAA,YAAA;AACF,MAAA,EAAA,CAAA,YAAA;AACF,MAAA,EAAA,CAAA,YAAA;AACF,MAAA,EAAA,CAAA,YAAA;AACA,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,oBAAA,EAAA,CAAA;AACE,MAAA,EAAA,CAAA,cAAA,CAAA,EAAA,EAAA,QAAA,EAAA,CAAA;AAA2D,MAAA,EAAA,CAAA,MAAA,CAAA,EAAA,EAAA,4CAAA;AAAO,MAAA,EAAA,CAAA,YAAA;AACpE,MAAA,EAAA,CAAA,YAAA;;;;AA1BqB,MAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,MAAA,EAAA,CAAA,kBAAA,CAAA,oGAAA,EAAA,GAAA,CAAA,IAAA,CAAA,IAAA,CAAA,IAAA,EAAA,EAAA;AAGe,MAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,MAAA,EAAA,CAAA,UAAA,CAAA,SAAA,EAAA,GAAA,CAAA,IAAA,CAAA,KAAA;AAUZ,MAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AAAA,MAAA,EAAA,CAAA,UAAA,CAAA,SAAA,EAAA,GAAA,CAAA,QAAA","sourcesContent":["import {AfterViewChecked, Component, ElementRef, Inject, Input, OnInit, ViewChild} from '@angular/core';\nimport {DataHandlerService} from \"../../services/data-handler.service\";\nimport {User} from \"../../model/user\";\nimport {Room} from \"../../model/room\";\nimport {Message} from \"../../model/message\";\nimport {RoomService} from \"../../services/room.service\";\nimport {MAT_DIALOG_DATA, MatDialog, MatDialogRef} from \"@angular/material/dialog\";\nimport {MessageService} from \"../../services/message.service\";\nimport {TokenStorageService} from \"../../services/token-storage.service\";\nimport {NotificationService} from \"../../services/notification.service\";\nimport {ImageUploadService} from \"../../services/image-upload.service\";\nimport {filter, map} from \"rxjs/operators\";\nimport {Observable} from \"rxjs\";\n\n@Component({\n  selector: 'app-message-list',\n  templateUrl: './message-list.component.html',\n  styleUrls: ['./message-list.component.css']\n})\nexport class MessageListComponent implements OnInit, AfterViewChecked {\n\n  users!: User[];\n  activeRoom!: Room;\n  messages!: Message[];\n  currentUserId!: number;\n  selfMessage: String = \"ks-self\";\n  fromMessage: String = \"ks-from\";\n  userImages: Map<number, File> = new Map<number, File>();\n\n  newMessageText!: String;\n  @ViewChild('scrollMe') private myScrollContainer!: ElementRef;\n  disableScrollDown = false;\n\n\n  constructor(private dataHandlerService: DataHandlerService,\n              private roomService: RoomService,\n              public messageService: MessageService,\n              public dialog: MatDialog,\n              private tokenStorageService: TokenStorageService,\n              private notificationService: NotificationService,\n              public imageService: ImageUploadService) {\n  }\n\n  ngOnInit(): void {\n    this.userImages = this.imageService.userImages;\n    this.currentUserId = this.tokenStorageService.getUser().user_id;\n    console.log(\"TEMP userId=\"+this.currentUserId);\n    //this.users = this.dataHandlerService.getUserList();\n    //this.messages = this.dataHandlerService.getMessages();\n    this.roomService.selectedRoom.subscribe(room => {\n      this.activeRoom = room;\n      this.users = room.users;\n      this.messageService.getAllMessages(this.activeRoom.id);\n      this.imageService.getUsersImagesFromRoom(room);\n    });\n    this.messageService.subjectMessages.subscribe((messages) => {\n      this.messages = messages;\n      this.disableScrollDown = false\n      this.scrollToBottom();\n    })\n    this.messageService.subjectMessage.subscribe((message) => {\n      if (this.activeRoom.id === message.room_id) {\n        this.messages.push(message);\n        this.disableScrollDown = false;\n        this.scrollToBottom();\n        console.log(\"Новое сообщение из текущей комнаты \" + message.room_id);\n      } else {\n        console.log(\"Новое сообщение из комнаты \" + message.room_id);\n        this.notificationService.showSnackBar(\"Новое сообщение из комнаты \" + message.room_id);\n      }\n    })\n    this.scrollToBottom();\n  }\n  //*ngIf=\"getSenderImage(message.sender_id) | async; let image\"\n\n  ngAfterViewChecked() {\n    this.scrollToBottom();\n  }\n\n  formatImage(img: any): any {\n    if (img == null) {\n      return null;\n    }\n    return 'data:image/jpeg;base64,' + img;\n  }\n\n  onReceivedImage(data : any) : any {\n    return data.imageBytes;\n  }\n\n  getSenderImage(senderId: number): Observable<String> {\n    return this.imageService.getUserImage(senderId).pipe(\n      map(val => ('data:image/jpeg;base64,' +val.imageBytes))\n    );\n  }\n\n\n\n  onScroll() {\n    let element = this.myScrollContainer.nativeElement\n    let atBottom = element.scrollHeight - element.scrollTop === element.clientHeight\n    this.disableScrollDown = !(this.disableScrollDown && atBottom);\n  }\n\n  scrollToBottom(): void {\n    if (this.disableScrollDown) {\n      return;\n    }\n    try {\n      this.myScrollContainer.nativeElement.scrollTop = this.myScrollContainer.nativeElement.scrollHeight;\n    } catch(err) { }\n  }\n\n  openDialogMembers() {\n    const dialogRef = this.dialog.open(DialogMembers, {\n      //width: '250px',\n     // height: '50%',\n      data: {room: this.activeRoom, users: this.users}\n    });\n\n    dialogRef.afterClosed().subscribe(result => {\n      console.log('The dialog was closed');\n    });\n  }\n\n  sendMessage() {\n    if (this.newMessageText && this.newMessageText.length>0) {\n        this.messageService.createMessage(this.activeRoom.id, this.newMessageText);\n        this.newMessageText = '';\n    } else {\n      console.log(\"Сообщение пустое!\");\n    }\n  }\n}\nexport interface MemberDialogData {\n  room: Room;\n  users: User[];\n}\n@Component({\n  selector: 'dialog-members',\n  templateUrl: 'dialog-members.html',\n  styleUrls: ['./message-list.component.css']\n})\nexport class DialogMembers {\n  nickname!:string;\n\n  constructor(\n    public dialogRef: MatDialogRef<DialogMembers>,\n    @Inject(MAT_DIALOG_DATA) public data: MemberDialogData,\n    private roomService: RoomService) {}\n\n  addUser() {\n    this.roomService.addUserToRoom(this.nickname, this.data.room.id);\n  }\n}\n","<div class=\"ks-messages ks-messenger__messages\">\n  <div class=\"ks-header\">\n    <div class=\"ks-description\">\n      <div class=\"ks-name\">{{activeRoom ? activeRoom.name : 'Имя комнаты'}}</div>\n      <div class=\"ks-amount\">{{activeRoom ? activeRoom.users.length : 'Количество'}} участников</div>\n    </div>\n    <div *ngIf=\"activeRoom\" class=\"ks-controls\">\n      <button mat-icon-button (click)=\"openDialogMembers()\">\n        <mat-icon>groups</mat-icon>\n      </button>\n    </div>\n  </div>\n  <div class=\"ks-body ks-scrollable jspScrollable\"\n       data-reduce-height=\".ks-footer\"\n       style=\"height: 480px; overflow-y: scroll; overflow-x: hidden; padding: 0px; width: 701px;\"\n       tabindex=\"0\" #scrollMe (scroll)=\"onScroll()\">\n    <div class=\"jspContainer\" style=\"width: 601px;\">\n      <div class=\"jspPane\" style=\"padding: 0px; top: 0px; width: 691px;\">\n        <ul class=\"ks-items\">\n          <li *ngIf=\"!activeRoom\" class=\"ks-separator\">Сообщения комнаты</li>\n          <li class=\"ks-item {{message.sender_id===currentUserId ? selfMessage: fromMessage}}\" *ngFor=\"let message of messages \">\n           <span class=\"ks-avatar ks-offline\">\n            <img class=\"rounded-circle\" height=\"36\"\n                 [src]=\"formatImage(userImages?.get(message.sender_id)) || 'https://www.missingdogsuk.co.uk/wp-content/plugins/wp-job-manager-resumes/assets/images/candidate.png'\" alt=\"user image\"\n                 width=\"36\">\n            </span>\n            <div class=\"ks-body\">\n              <div class=\"ks-header\">\n                <span class=\"ks-name\">{{messageService.getUserFromUserIdInRoom(activeRoom, message.sender_id) ? messageService.getUserFromUserIdInRoom(activeRoom, message.sender_id)?.nickname : ''}}</span>\n                <span class=\"ks-datetime\">{{message.sendingDate | date:'short'}}</span>\n              </div>\n              <div class=\"ks-message\">{{message.text}}</div>\n            </div>\n          </li>\n        </ul>\n      </div>\n      <div class=\"jspVerticalBar\">\n        <div class=\"jspCap jspCapTop\"></div>\n        <div class=\"jspTrack\" style=\"height: 390px;\">\n          <div class=\"jspDrag\" style=\"height: 206px;\">\n            <div class=\"jspDragTop\"></div>\n            <div class=\"jspDragBottom\"></div>\n          </div>\n        </div>\n        <div class=\"jspCap jspCapBottom\"></div>\n      </div>\n    </div>\n  </div>\n  <div class=\"ks-footer\">\n    <mat-form-field class=\"form-control\" hintLabel=\"Как ваши дела?\" >\n        <mat-label>Текст сообщения</mat-label>\n        <textarea [disabled]=\"!activeRoom\"  [cdkTextareaAutosize]=\"true\" [matTextareaAutosize]=\"false\" matInput [(ngModel)]=\"newMessageText\"></textarea>\n    </mat-form-field>\n    <div class=\"ks-controls\">\n      <button mat-raised-button [disabled]=\"!activeRoom\" class=\"btn btn-primary\" (click)=\"sendMessage()\">Отправить</button>\n    </div>\n  </div>\n</div>\n","<h2 mat-dialog-title>Настройки комнаты {{data.room.name}}</h2>\r\n<mat-dialog-content class=\"mat-typography\">\r\n  <mat-list>Пользователи:\r\n    <mat-list-item *ngFor=\"let user of data.users\">\r\n      <mat-icon>face</mat-icon>Имя:&nbsp;<b>{{user.nickname}}</b>\r\n      <button mat-icon-button [disabled]=\"true\" style=\"position: absolute; right: 20px\">\r\n        <mat-icon>clear</mat-icon>\r\n      </button>\r\n    </mat-list-item>\r\n    <mat-divider></mat-divider>\r\n    <mat-list-item>\r\n      <mat-form-field hintLabel=\"Добавить пользователя\">\r\n        <mat-label>Никнейм пользователя</mat-label>\r\n        <input matInput [(ngModel)]=\"nickname\">\r\n      </mat-form-field>\r\n      <span>\r\n        <button mat-raised-button class=\"add-user-button\" (click)=\"addUser()\">\r\n          <mat-icon>add_circle_outline</mat-icon>\r\n          Добавить\r\n        </button>\r\n      </span>\r\n    </mat-list-item>\r\n  </mat-list>\r\n</mat-dialog-content>\r\n<mat-dialog-actions align=\"end\">\r\n  <button mat-button class=\"close-button\" [mat-dialog-close]>Закрыть</button>\r\n</mat-dialog-actions>\r\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}